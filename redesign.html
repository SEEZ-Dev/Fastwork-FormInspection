<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>INPROCESS INSPECTION (PIPE) - W-FM-QA-13 R09</title>
    <style>
      :root {
        --primary-color: #007bff;
        --secondary-color: #6c757d;
        --accent-color: #a4e2ff4d;
      }
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: Arial, sans-serif;
        font-size: 12px;
        background-color: #f5f5f5;
        padding: 20px;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        border-bottom: 2px solid #333;
        padding-bottom: 10px;
      }
      .header h1 {
        font-size: 24px;
        font-weight: bold;
        text-align: center;
        flex: 1;
      }
      .form-number {
        text-align: right;
        font-weight: bold;
      }
      .toolbar {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 5px;
      }
      .btn {
        padding: 8px 16px;
        border: 1px solid #ddd;
        background: white;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        transition: background-color 0.2s;
      }
      .btn:hover {
        background: #e9ecef;
      }
      .btn-primary {
        background: #007bff;
        color: white;
        border-color: #007bff;
      }
      .btn-primary:hover {
        background: #0056b3;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        border: 2px solid #000;
      }
      th,
      td {
        border: 1px solid #000;
        padding: 8px;
        text-align: left;
        vertical-align: top;
      }
      .table-header {
        background-color: #f0f0f0;
        font-weight: bold;
        text-align: center;
      }
      .input-field {
        width: 100%;
        border: none;
        border-bottom: 1px solid #ccc;
        background: transparent;
        padding: 4px;
        font-size: 12px;
      }
      .input-field:focus {
        background: var(--accent-color);
        border: none;
        border-bottom: 1px solid #ccc;
      }
      .checkbox-container {
        display: flex;
        align-items: center;
        gap: 5px;
        margin-right: 15px;
      }
      .checkbox {
        width: 16px;
        height: 16px;
      }
      .measurement-table {
        width: 100%;
        border-collapse: collapse;
      }
      .measurement-table th,
      .measurement-table td {
        border: 1px solid #000;
        padding: 4px;
        text-align: center;
      }
      .measurement-table input {
        width: 100%;
        border: none;
        text-align: center;
        padding: 2px;
        background: transparent;
      }
      .measurement-table input:focus {
        background: #fff3cd;
        outline: 1px solid #ffc107;
      }
      .add-row-btn {
        margin-top: 5px;
        padding: 4px 8px;
        font-size: 11px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
      }
      .add-row-btn:hover {
        background: #218838;
      }
      .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      .grid-3 {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 10px;
      }
      .grid-4 {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr 1fr;
        gap: 10px;
      }
      .grid-6 {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 10px;
      }
      .form-group {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 5px;
      }
      .form-group label {
        font-weight: 500;
        white-space: nowrap;
      }
      .auto-calc {
        background: #e3f2fd;
        border: 1px solid #2196f3;
        border-radius: 5px;
        padding: 15px;
        margin: 20px 0;
      }
      .auto-calc h3 {
        color: #1976d2;
        margin-bottom: 10px;
        font-size: 14px;
      }
      .calc-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
      }
      .calc-item {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
      }
      .calc-value {
        font-weight: bold;
        color: #1976d2;
      }
      .section {
        margin-bottom: 20px;
        border: 2px solid #000;
      }
      .section-header {
        background: #f0f0f0;
        padding: 10px;
        font-weight: bold;
        text-align: center;
        border-bottom: 1px solid #000;
      }
      .section-content {
        padding: 15px;
      }
      .characteristics-grid {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
      }
      .footer {
        text-align: center;
        font-size: 11px;
        color: #666;
        border-top: 1px solid #ddd;
        padding-top: 15px;
        margin-top: 20px;
      }
      @media print {
        .toolbar {
          display: none;
        }
        body {
          background: white;
          padding: 0;
        }
        .container {
          box-shadow: none;
          border-radius: 0;
        }
      }
      .error {
        border: 1px solid #dc3545 !important;
        background: #f8d7da !important;
      }
      .success {
        border: 1px solid #28a745 !important;
        background: #d4edda !important;
      }
      /* Responsive adjustments */
      @media (max-width: 1024px) {
        .grid-2,
        .grid-3,
        .grid-4,
        .grid-6 {
          grid-template-columns: 1fr;
        }
        .form-group {
          flex-direction: column;
          align-items: flex-start;
        }
        .form-group label {
          margin-bottom: 4px;
        }
        .characteristics-grid {
          flex-direction: column;
          gap: 10px;
        }
        .toolbar {
          flex-direction: column;
          gap: 5px;
        }
        .header {
          flex-direction: column;
          align-items: flex-start;
        }
        .header h1 {
          font-size: 18px;
        }
        .header .form-number {
          text-align: left;
          margin-top: 10px;
        }
        .container {
          padding: 10px;
        }
        table {
          font-size: 11px;
        }
        img {
          max-width: 100%;
          height: auto;
        }
        .calc-grid {
          grid-template-columns: 1fr;
        }
        .auto-calc h3 {
          font-size: 12px;
        }
      }
      @media (max-width: 600px) {
        body {
          font-size: 11px;
          padding: 10px;
        }
        .header h1 {
          font-size: 16px;
        }
        .btn {
          font-size: 11px;
          padding: 6px 12px;
        }
        .add-row-btn {
          font-size: 10px;
          padding: 2px 6px;
        }
        .input-field {
          font-size: 11px;
        }
        .section-header {
          font-size: 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <h1>INPROCESS INSPECTION (PIPE)</h1>
        <div class="form-number">
          <div>W-FM-QA-13 R09</div>
          <div style="font-size: 10px; color: #666">
            Effective Date: 01/04/2564
          </div>
        </div>
      </div>

      <!-- Toolbar -->
      <div class="toolbar">
        <button class="btn" onclick="saveForm()">üíæ Save</button>
        <button class="btn" onclick="clearForm()">üóëÔ∏è Clear</button>
      </div>

      <!-- Basic Information -->
      <div class="section">
        <div class="section-content">
          <div class="grid-2">
            <!-- Left section -->
            <div>
              <div class="grid-2" id="general-info"></div>

              <div class="grid-2">
                <div class="form-group">
                  <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡πà‡∏≠:</label>
                  <label class="block-label">
                    <input
                      type="radio"
                      name="pipeType"
                      value="‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡∏ú‡∏¥‡∏ß"
                      onchange="saveToStorage()"
                    />
                    ‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡∏ú‡∏¥‡∏ß
                  </label>
                  <label class="block-label">
                    <input
                      type="radio"
                      name="pipeType"
                      value="‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡∏™‡∏±‡∏á‡∏Å‡∏∞‡∏™‡∏µ"
                      onchange="saveToStorage()"
                    />
                    ‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡∏™‡∏±‡∏á‡∏Å‡∏∞‡∏™‡∏µ (GI/GA)
                  </label>
                </div>

                <div class="form-group">
                  <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏ô‡∏ß‡∏±‡∏î‡∏≠‡∏á‡∏®‡∏≤:</label>
                  <input
                    type="text"
                    class="input-field"
                    id="degreePlateNumber"
                    onchange="saveToStorage()"
                  />
                </div>
              </div>
            </div>

            <!-- Images -->
            <div style="display: flex; justify-content: center">
              <img
                src="/public/circle-ref.png"
                style="max-height: 200px"
                alt="circle-ref"
              />
              <img
                src="/public/square-ref.png"
                style="max-height: 200px"
                alt="square-ref"
              />
            </div>
          </div>

          <!-- Eddy Current Testing -->
          <div class="form-group">
            <input
              type="checkbox"
              id="eddyCurrentTest"
              onchange="saveToStorage()"
            />
            <label for="eddyCurrentTest">
              ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡πÅ‡∏ô‡∏ß‡∏ï‡∏∞‡πÄ‡∏Ç‡πá‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡πÇ‡∏ï‡∏£‡πÅ‡∏°‡∏Å‡πÄ‡∏ô‡∏ï‡∏¥‡∏Å (Eddy Current
              Testing)
            </label>
          </div>

          <!-- Marking details -->
          <div class="form-group">
            <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏û‡πà‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏â‡∏•‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤:</label>
            <div class="checkbox-container">
              <input
                type="radio"
                id="tmt3Point"
                name="marking"
                onchange="toggleTmtTis107Input(); saveToStorage()"
              />
              <label for="tmt3Point">TMT 3 ‡∏à‡∏∏‡∏î</label>
            </div>

            <div class="checkbox-container">
              <input
                type="radio"
                id="tmtTis107"
                name="marking"
                onchange="toggleTmtTis107Input(); saveToStorage()"
              />
              <label for="tmtTis107">TMT TIS 107 -</label>
              <input
                type="text"
                class="input-field"
                id="tmtTis107Value"
                style="width: 200px"
                disabled
                onchange="saveToStorage()"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Characteristics -->
      <div class="section">
        <div class="section-header">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
        <div class="section-content">
          <div class="characteristics-grid">
            <div class="checkbox-container">
              <input
                type="checkbox"
                class="checkbox"
                id="line3"
                onchange="saveToStorage()"
              />
              <label for="line3">3 ‡πÄ‡∏™‡πâ‡∏ô</label>
            </div>
            <div class="checkbox-container">
              <input
                type="checkbox"
                class="checkbox"
                id="line4"
                onchange="saveToStorage()"
              />
              <label for="line4">4 ‡πÄ‡∏™‡πâ‡∏ô</label>
            </div>
            <div class="checkbox-container">
              <input
                type="checkbox"
                class="checkbox"
                id="line5"
                onchange="saveToStorage()"
              />
              <label for="line5">5 ‡πÄ‡∏™‡πâ‡∏ô</label>
            </div>
            <div class="checkbox-container">
              <input
                type="checkbox"
                class="checkbox"
                id="lineOther"
                onchange="saveToStorage()"
              />
              <input
                type="text"
                class="input-field"
                id="lineOtherValue"
                style="width: 50px"
                onchange="saveToStorage()"
              />
              <label>‡πÄ‡∏™‡πâ‡∏ô</label>
            </div>
          </div>

          <div style="margin-top: 20px">
            <div class="grid-2">
              <div class="form-group">
                <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å/‡∏°‡∏±‡∏î:</label>
                <input
                  type="number"
                  class="input-field"
                  id="weight"
                  step="0.01"
                  onchange="saveToStorage()"
                />
                <label>‡∏Å.‡∏Å.</label>
              </div>
              <div class="form-group">
                <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏£‡∏î A:</label>
                <input
                  type="number"
                  class="input-field"
                  id="gradeACount"
                  onchange="saveToStorage()"
                />
                <label>‡πÄ‡∏™‡πâ‡∏ô</label>
              </div>
            </div>
          </div>

          <div style="margin-top: 20px">
            <div class="grid-2">
              <div class="form-group">
                <label>‡∏£‡∏ß‡∏° (‡∏ä‡∏¥‡πâ‡∏ô):</label>
                <input
                  type="number"
                  class="input-field"
                  id="totalPieces"
                  readonly
                  style="background: #f8f9fa"
                />
              </div>
              <div class="form-group">
                <label>‡∏£‡∏ß‡∏° (‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°):</label>
                <input
                  type="number"
                  class="input-field"
                  id="totalKg"
                  step="0.01"
                  onchange="saveToStorage()"
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- OD Measurements -->
      <div class="section">
        <div class="section-header">
          ‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (OD) Measurements
        </div>
        <div class="section-content">
          <div class="grid-2">
            <div>
              <div class="form-group">
                <label>‚óã ‡∏ó‡πà‡∏≠‡∏Å‡∏•‡∏° ‡∏Ç‡∏ô‡∏≤‡∏î:</label>
                <input
                  type="text"
                  class="input-field"
                  id="odSpec"
                  onchange="saveToStorage()"
                />
              </div>
              <div class="form-group">
                <label>+/-:</label>
                <input
                  type="number"
                  class="input-field"
                  id="odTolerance"
                  step="0.01"
                  onchange="saveToStorage()"
                />
                <label>mm.</label>
              </div>
              <div class="form-group">
                <label>Range (</label>
                <input
                  type="number"
                  class="input-field"
                  id="odRangeMin"
                  step="0.01"
                  style="width: 80px"
                  onchange="saveToStorage()"
                />
                <label>-</label>
                <input
                  type="number"
                  class="input-field"
                  id="odRangeMax"
                  step="0.01"
                  style="width: 80px"
                  onchange="saveToStorage()"
                />
                <label>mm. )</label>
              </div>
            </div>
            <div>
              <table class="measurement-table">
                <thead>
                  <tr>
                    <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                    <th>‡∏î‡πâ‡∏≤‡∏ô A</th>
                    <th>‡∏î‡πâ‡∏≤‡∏ô B</th>
                    <th>‡∏î‡πâ‡∏≤‡∏ô C</th>
                    <th>‡∏î‡πâ‡∏≤‡∏ô D</th>
                    <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                  </tr>
                </thead>
                <tbody id="odMeasurements">
                  <!-- Rows will be added dynamically -->
                </tbody>
              </table>
              <button class="add-row-btn" onclick="addODRow()">
                + Add Row
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Thickness Measurements -->
      <div class="section">
        <div class="section-header">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤ (Thickness) Measurements</div>
        <div class="section-content">
          <div class="grid-2">
            <div>
              <div class="form-group">
                <label>‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏≤‡∏á:</label>
                <input
                  type="number"
                  class="input-field"
                  id="thicknessAvg"
                  step="0.01"
                  onchange="saveToStorage()"
                />
              </div>
              <div class="form-group">
                <label>+:</label>
                <input
                  type="number"
                  class="input-field"
                  id="thicknessPlus"
                  step="0.01"
                  onchange="saveToStorage()"
                />
                <label>mm.</label>
              </div>
              <div class="form-group">
                <label>-:</label>
                <input
                  type="number"
                  class="input-field"
                  id="thicknessMinus"
                  step="0.01"
                  onchange="saveToStorage()"
                />
                <label>mm.</label>
              </div>
              <div class="form-group">
                <label>Range (</label>
                <input
                  type="number"
                  class="input-field"
                  id="thicknessRangeMin"
                  step="0.01"
                  style="width: 80px"
                  onchange="saveToStorage()"
                />
                <label>-</label>
                <input
                  type="number"
                  class="input-field"
                  id="thicknessRangeMax"
                  step="0.01"
                  style="width: 80px"
                  onchange="saveToStorage()"
                />
                <label>mm. )</label>
              </div>
            </div>
            <div>
              <table class="measurement-table">
                <thead>
                  <tr>
                    <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                    <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á A</th>
                    <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á B</th>
                    <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á C</th>
                    <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á D</th>
                    <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                  </tr>
                </thead>
                <tbody id="thicknessMeasurements">
                  <!-- Rows will be added dynamically -->
                </tbody>
              </table>
              <button class="add-row-btn" onclick="addThicknessRow()">
                + Add Row
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Equipment Numbers -->
      <div class="section">
        <div class="section-header">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏±‡∏î</div>
        <div class="section-content">
          <div class="grid-4">
            <div class="form-group">
              <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ï‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ï‡∏£:</label>
              <input
                type="text"
                class="input-field"
                id="tapeNumber"
                onchange="saveToStorage()"
              />
            </div>
            <div class="form-group">
              <label>Vernier No.:</label>
              <input
                type="text"
                class="input-field"
                id="vernierNumber"
                onchange="saveToStorage()"
              />
            </div>
            <div class="form-group">
              <label>Micrometer No.:</label>
              <input
                type="text"
                class="input-field"
                id="micrometerNumber"
                onchange="saveToStorage()"
              />
            </div>
            <div class="form-group">
              <label>Reflextrometer No.:</label>
              <input
                type="text"
                class="input-field"
                id="reflextrometer"
                onchange="saveToStorage()"
              />
            </div>
            <div class="form-group">
              <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î:</label>
              <input
                type="text"
                class="input-field"
                id="rulerNumber"
                onchange="saveToStorage()"
              />
            </div>
            <div class="form-group">
              <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡∏±‡πà‡∏á:</label>
              <input
                type="text"
                class="input-field"
                id="scaleNumber"
                onchange="saveToStorage()"
              />
            </div>
            <div class="form-group">
              <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏ô‡∏ß‡∏±‡∏î‡∏≠‡∏á‡∏®‡∏≤:</label>
              <input
                type="text"
                class="input-field"
                id="protractorNumber"
                onchange="saveToStorage()"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Pipe Type and Testing -->
      <div class="section">
        <div class="section-header">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</div>
        <div class="section-content">
          <div class="characteristics-grid">
            <div class="checkbox-container">
              <input
                type="checkbox"
                class="checkbox"
                id="uncoated"
                onchange="saveToStorage()"
              />
              <label for="uncoated">‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡∏ú‡∏¥‡∏ß</label>
            </div>
            <div class="checkbox-container">
              <input
                type="checkbox"
                class="checkbox"
                id="galvanized"
                onchange="saveToStorage()"
              />
              <label for="galvanized">‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö‡∏™‡∏±‡∏á‡∏Å‡∏∞‡∏™‡∏µ (GI/GA)</label>
            </div>
          </div>

          <div style="margin-top: 15px">
            <div class="checkbox-container">
              <input
                type="checkbox"
                class="checkbox"
                id="eddyCurrentTest"
                onchange="saveToStorage()"
              />
              <label for="eddyCurrentTest"
                >‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡πÅ‡∏ô‡∏ß‡∏ï‡∏∞‡πÄ‡∏Ç‡πá‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡πÇ‡∏ï‡∏£‡πÅ‡∏°‡∏Å‡πÄ‡∏ô‡∏ï‡∏¥‡∏Å (Eddy Current
                Testing)</label
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Product Arrangement and Quality -->
      <div class="section">
        <div class="section-header">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</div>
        <div class="section-content">
          <div class="grid-3">
            <div class="form-group">
              <label>‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢‡∏£‡∏±‡∏î:</label>
              <input
                type="number"
                class="input-field"
                id="strapSize"
                onchange="saveToStorage()"
              />
              <label>mm.</label>
            </div>
            <div class="form-group">
              <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏û‡πá‡∏Ñ‡∏™‡∏≤‡∏¢‡∏£‡∏±‡∏î:</label>
              <input
                type="number"
                class="input-field"
                id="strapCount"
                onchange="saveToStorage()"
              />
            </div>
          </div>

          <div style="margin-top: 15px">
            <div class="grid-3">
              <div class="form-group">
                <label>‡∏´‡∏±‡∏ß:</label>
                <input
                  type="text"
                  class="input-field"
                  id="strapHead"
                  onchange="saveToStorage()"
                />
              </div>
              <div class="form-group">
                <label>‡∏Å‡∏•‡∏≤‡∏á:</label>
                <input
                  type="text"
                  class="input-field"
                  id="strapMiddle"
                  onchange="saveToStorage()"
                />
              </div>
              <div class="form-group">
                <label>‡∏ó‡πâ‡∏≤‡∏¢:</label>
                <input
                  type="text"
                  class="input-field"
                  id="strapTail"
                  onchange="saveToStorage()"
                />
              </div>
            </div>
          </div>

          <div style="margin-top: 15px">
            <div class="form-group">
              <label>‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (NG):</label>
              <input
                type="text"
                class="input-field"
                id="ngReason"
                onchange="saveToStorage()"
              />
            </div>
          </div>

          <div style="margin-top: 15px">
            <div class="grid-4">
              <div class="form-group">
                <label>‡πÄ‡∏Å‡∏£‡∏î A:</label>
                <input
                  type="number"
                  class="input-field"
                  id="gradeA"
                  onchange="calculateTotals(); saveToStorage()"
                />
              </div>
              <div class="form-group">
                <label>‡πÄ‡∏Å‡∏£‡∏î B:</label>
                <input
                  type="number"
                  class="input-field"
                  id="gradeB"
                  onchange="calculateTotals(); saveToStorage()"
                />
              </div>
              <div class="form-group">
                <label>Scrap:</label>
                <input
                  type="number"
                  class="input-field"
                  id="scrap"
                  onchange="calculateTotals(); saveToStorage()"
                />
              </div>
              <div class="form-group">
                <label>‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</label>
                <input
                  type="text"
                  class="input-field"
                  id="inspector"
                  onchange="saveToStorage()"
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Auto Calculations -->
      <div class="auto-calc">
        <h3>üßÆ Auto Calculations</h3>
        <div class="calc-grid">
          <div class="calc-item">
            <span>Total Pieces:</span>
            <span class="calc-value" id="calcTotalPieces">0</span>
          </div>
          <div class="calc-item">
            <span>Grade A Count:</span>
            <span class="calc-value" id="calcGradeA">0</span>
          </div>
          <div class="calc-item">
            <span>Total Weight:</span>
            <span class="calc-value" id="calcTotalWeight">0 kg</span>
          </div>
        </div>
      </div>

      <!-- Reference Shapes -->
      <div class="section">
        <div class="section-header">‡∏£‡∏π‡∏õ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ</div>
        <div class="section-content">
          <div class="grid-3">
            <div style="text-align: center">
              <div style="font-weight: bold; margin-bottom: 10px">
                ‡∏£‡∏π‡∏õ‡∏´‡∏Å‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°
              </div>
              <div>A B C D E F</div>
            </div>
            <div style="text-align: center">
              <div style="font-weight: bold; margin-bottom: 10px">
                ‡∏£‡∏π‡∏õ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™
              </div>
              <div>A B C D</div>
            </div>
            <div style="text-align: center">
              <div style="font-weight: bold; margin-bottom: 10px">
                ‡∏£‡∏π‡∏õ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ú‡∏∑‡∏ô‡∏ú‡πâ‡∏≤
              </div>
              <div>A B C D E</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="footer">
        W-FM-QA-13 R09 | Effective Date: 01/04/2564 | Page 1 of 2
      </div>
    </div>

    <script>
      // Initialize the form
      document.addEventListener("DOMContentLoaded", function () {
        initializeMeasurementTables();
        loadFromStorage();
        calculateTotals();
      });

      const generalFields = [
        { label: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏±‡∏Å‡∏£:", id: "machine", type: "text" },
        { label: "Vernier No.:", id: "vernierNumber", type: "text" },
        { label: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï:", id: "productionDate", type: "date" },
        { label: "Micrometer No.:", id: "micrometerNumber", type: "text" },
        { label: "‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï:", id: "orderNumber", type: "text" },
        {
          label: "Reflextrometer No.:",
          id: "reflextrometerNumber",
          type: "text",
        },
        { label: "‡πÄ‡∏Å‡∏£‡∏î‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö:", id: "materialGrade", type: "text" },
        { label: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ï‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ï‡∏£:", id: "tapeNumber", type: "text" },
        { label: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ü‡∏¥‡∏•‡πå‡∏°:", id: "filmWidth", type: "text" },
        { label: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î:", id: "rulerNumber", type: "text" },
        { label: "‡∏Ç‡∏ô‡∏≤‡∏î‡∏ú‡∏•‡∏¥‡∏ï:", id: "productSize", type: "text" },
        { label: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡∏±‡πà‡∏á:", id: "scaleNumber", type: "text" },
      ];

      const container = document.getElementById("general-info");

      generalFields.forEach((field) => {
        const formGroup = document.createElement("div");
        formGroup.className = "form-group";

        const label = document.createElement("label");
        label.textContent = field.label;

        const input = document.createElement("input");
        input.type = field.type;
        input.className = "input-field";
        input.id = field.id;
        input.onchange = () => saveToStorage();

        formGroup.appendChild(label);
        formGroup.appendChild(input);

        container.appendChild(formGroup);
      });

      // Initialize measurement tables with default rows
      function initializeMeasurementTables() {
        // Add 3 default rows for OD measurements
        for (let i = 0; i < 3; i++) {
          addODRow();
        }

        // Add 3 default rows for thickness measurements
        for (let i = 0; i < 3; i++) {
          addThicknessRow();
        }
      }

      // Add OD measurement row
      function addODRow() {
        const tbody = document.getElementById("odMeasurements");
        const rowCount = tbody.children.length;
        const row = document.createElement("tr");

        row.innerHTML = `
                <td><input type="time" class="input-field" id="odTime${rowCount}" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="odSideA${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="odSideB${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="odSideC${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="odSideD${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="text" class="input-field" id="odNotes${rowCount}" onchange="saveToStorage()"></td>
            `;

        tbody.appendChild(row);
      }

      // Add thickness measurement row
      function addThicknessRow() {
        const tbody = document.getElementById("thicknessMeasurements");
        const rowCount = tbody.children.length;
        const row = document.createElement("tr");

        row.innerHTML = `
                <td><input type="time" class="input-field" id="thicknessTime${rowCount}" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="thicknessPosA${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="thicknessPosB${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="thicknessPosC${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="number" class="input-field" id="thicknessPosD${rowCount}" step="0.01" onchange="saveToStorage()"></td>
                <td><input type="text" class="input-field" id="thicknessNotes${rowCount}" onchange="saveToStorage()"></td>
            `;

        tbody.appendChild(row);
      }

      function toggleTmtTis107Input() {
        const tmtTis107Radio = document.getElementById("tmtTis107");
        const inputField = document.getElementById("tmtTis107Value");
        inputField.disabled = !tmtTis107Radio.checked;
      }
      // Calculate totals automatically
      function calculateTotals() {
        const gradeA = parseFloat(document.getElementById("gradeA").value) || 0;
        const gradeB = parseFloat(document.getElementById("gradeB").value) || 0;
        const scrap = parseFloat(document.getElementById("scrap").value) || 0;
        const weight = parseFloat(document.getElementById("weight").value) || 0;

        const totalPieces = gradeA + gradeB + scrap;

        // Update calculated fields
        document.getElementById("totalPieces").value = totalPieces;
        document.getElementById("calcTotalPieces").textContent = totalPieces;
        document.getElementById("calcGradeA").textContent = gradeA;
        document.getElementById("calcTotalWeight").textContent = weight + " kg";
      }

      // Save form data to localStorage
      function saveToStorage() {
        const formData = {};
        const inputs = document.querySelectorAll("input");

        inputs.forEach((input) => {
          if (input.type === "checkbox") {
            formData[input.id] = input.checked;
          } else {
            formData[input.id] = input.value;
          }
        });

        localStorage.setItem("inspectionForm", JSON.stringify(formData));
      }

      function saveForm() {
        const formData = {};
        const inputs = document.querySelectorAll("input");

        inputs.forEach((input) => {
          if (input.type === "checkbox") {
            formData[input.id] = input.checked;
          } else {
            formData[input.id] = input.value;
          }
        });

        const dataStr = JSON.stringify(formData, null, 2);
        const blob = new Blob([dataStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = "inspection-form.json";
        link.click();
        URL.revokeObjectURL(url);
      }

      function clearForm() {
        if (confirm("Are you sure you want to clear all data?")) {
          const inputs = document.querySelectorAll("input");
          inputs.forEach((input) => {
            if (input.type === "checkbox") {
              input.checked = false;
            } else {
              input.value = "";
            }
          });

          calculateTotals();
          localStorage.removeItem("inspectionForm");
          alert("Form cleared!");
        }
      }
      // Auto-save every 30 seconds
      setInterval(saveToStorage, 30000);
    </script>
  </body>
</html>
